{% extends 'outbase.html' %}
{% load static %}

{% block content %}
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600&display=swap');

*{
    box-sizing:border-box;
    font-family:'Roboto',sans-serif!important;
}

body{
    background:#f8f9fb;
    color:#111827;
}

/* PAGE */
.page-wrap{
    width:100%;
    padding:24px 32px;
}

/* TITLE */
.page-title{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
    font-size:30px;
    font-weight:500;
    margin-bottom:26px;
}

.page-title img{
    width:52px;
}

/* CARD */
.card{
    background:#fff;
    border-radius:14px;
    box-shadow:0 8px 24px rgba(0,0,0,.08);
    padding:18px 18px 8px;
}

/* FILTER BAR */
.filters{
    display:flex;
    gap:14px;
    margin-bottom:18px;
    flex-wrap:wrap;
}

.filter-select{
    flex:1;
    min-width:260px;
    background:#fff;
    border:1px solid #e5e7eb;
    border-radius:10px;
    padding:14px 16px;
    font-size:15px;
    font-weight:400;
    color:#111;
}

/* TABLE */
.table-wrap{
    width:100%;
    overflow-x:auto;
}

.table{
    width:100%;
    border-collapse:collapse;
    min-width:1000px;
}

.table thead th{
    padding:16px 14px;
    font-size:15px;
    font-weight:600;
    border-bottom:1px solid #e5e7eb;
    text-align:left;
    text-transform:uppercase;
    letter-spacing:.4px;
}

.table tbody td{
    padding:18px 14px;
    font-size:15px;
    font-weight:400;
    border-bottom:1px solid #f1f1f1;
    vertical-align:top;
}

.table tbody tr:hover{
    background:#fafafa;
}

/* ACTION */
.view-link{
    color:#2563eb;
    font-weight:500;
    text-decoration:none;
}

.view-link:hover{
    text-decoration:underline;
}

/* EMPTY */
.empty{
    text-align:center;
    padding:26px;
    font-weight:500;
}

/* MOBILE */
@media(max-width:768px){
    .page-wrap{
        padding:20px;
    }
    .page-title{
        font-size:22px;
    }
}
</style>

<div class="page-wrap">

    <!-- TITLE -->
    <div class="page-title">
        <img src="{% static 'img/smalllogo.png' %}" alt="">
        Open Walk-Thru Items
    </div>

    <!-- CARD -->
    <div class="card">

        <!-- FILTERS -->
        <form method="get" class="filters">

            <!-- PROPERTY FILTER -->
            <select name="property" class="filter-select" onchange="this.form.submit()">
                <option value="">All Properties</option>
                {% for p in properties %}
                    <option value="{{ p.id }}"
                        {% if request.GET.property == p.id|stringformat:"s" %}selected{% endif %}>
                        {{ p.address }}
                    </option>
                {% endfor %}
            </select>

            <!-- MONTH FILTER -->
            <select name="month" class="filter-select" onchange="this.form.submit()">
                <option value="">All Months</option>
                {% for m in months %}
                    <option value="{{ m|date:'Y-m' }}"
                        {% if request.GET.month == m|date:'Y-m' %}selected{% endif %}>
                        {{ m|date:"F Y" }}
                    </option>
                {% endfor %}
            </select>

        </form>

        <!-- TABLE -->
        <div class="table-wrap">
            <table class="table">
                <thead>
                    <tr>
                        <th>REPORT DATE</th>
                        <th>DESCRIPTION</th>
                        <th>TOTAL COST</th>
                        <th>ACTION</th>
                    </tr>
                </thead>
                <tbody>
                    {% for report in reports %}
                    <tr>
                        <td>
                            {{ report.datetime|date:"M d, Y" }}<br>
                            {{ report.datetime|date:"h:i A" }}
                        </td>
                        <td>{{ report.description }}</td>
                        <td>${{ report.cost }}</td>
                        <td>
                            <a href="{% url 'mainapp:report_detail' report.pk %}" class="view-link">
                                View
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="empty">
                            No walk-thru items found
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
</div>

{% endblock content %}
